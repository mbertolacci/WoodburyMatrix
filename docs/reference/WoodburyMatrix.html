<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create a Woodbury matrix identity matrix — WoodburyMatrix • WoodburyMatrix</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create a Woodbury matrix identity matrix — WoodburyMatrix" />
<meta property="og:description" content="Creates an implicitly defined matrix representing the equation
$$A^{-1} + U B^{-1} V,$$
where \(A, U, B\) and \(V\) are n x n, n x p, p x p and p x n matrices,
respectively. A symmetric special case is also possible with
$$A^{-1} + X B^{-1} X',$$
where \(X\) is n x p and \(A\) and \(B\) are additionally symmetric.
The available methods are described in WoodburyMatrix-class
and in solve. Multiple B / U / V / X matrices are also supported; see
below" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">WoodburyMatrix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/WoodburyMatrix.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mbertolacci/WoodburyMatrix/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a Woodbury matrix identity matrix</h1>
    <small class="dont-index">Source: <a href='https://github.com/mbertolacci/WoodburyMatrix/blob/master/R/WoodburyMatrix.R'><code>R/WoodburyMatrix.R</code></a></small>
    <div class="hidden name"><code>WoodburyMatrix.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Creates an implicitly defined matrix representing the equation
$$A^{-1} + U B^{-1} V,$$
where \(A, U, B\) and \(V\) are n x n, n x p, p x p and p x n matrices,
respectively. A symmetric special case is also possible with
$$A^{-1} + X B^{-1} X',$$
where \(X\) is n x p and \(A\) and \(B\) are additionally symmetric.
The available methods are described in <a href='WoodburyMatrix-class.html'>WoodburyMatrix-class</a>
and in <a href='solve-methods.html'>solve</a>. Multiple B / U / V / X matrices are also supported; see
below</p>
    </div>

    <pre class="usage"><span class='fu'>WoodburyMatrix</span>(<span class='no'>A</span>, <span class='no'>B</span>, <span class='no'>U</span>, <span class='no'>V</span>, <span class='no'>X</span>, <span class='no'>O</span>, <span class='no'>symmetric</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>A</th>
      <td><p>Matrix \(A\) in the definition above.</p></td>
    </tr>
    <tr>
      <th>B</th>
      <td><p>Matrix \(B\) in the definition above, or list of matrices.</p></td>
    </tr>
    <tr>
      <th>U</th>
      <td><p>Matrix \(U\) in the definition above, or list of matrices.
Defaults to a diagonal matrix/matrices.</p></td>
    </tr>
    <tr>
      <th>V</th>
      <td><p>Matrix \(V\) in the definition above, or list of matrices.
Defaults to a diagonal matrix/matrices.</p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>Matrix \(X\) in the definition above, or list of matrices.
Defaults to a diagonal matrix/matrices.</p></td>
    </tr>
    <tr>
      <th>O</th>
      <td><p>Optional, precomputed value of \(O\), as defined above. THIS IS
NOT CHECKED FOR CORRECTNESS, and this argument is only provided for advanced
users who have precomputed the matrix for other purposes.</p></td>
    </tr>
    <tr>
      <th>symmetric</th>
      <td><p>Logical value, whether to create a symmetric or general
matrix. See Details section for more information.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code><a href='WoodburyMatrix-class.html'>GWoodburyMatrix</a></code> object for a non-symmetric
matrix, <code><a href='WoodburyMatrix-class.html'>SWoodburyMatrix</a></code> for a symmetric matrix.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The benefit of using an implicit representation is that the inverse
of this matrix can be efficiently calculated via
$$A - A U O^{-1} V A$$
where \(O = B + VAU\), and its determinant by
$$det(O) det(A)^{-1} det(B)^{-1}.$$
These relationships are often called the Woodbury matrix identity and the
matrix determinant lemma, respectively. If \(A\) and \(B\) are sparse or
otherwise easy to deal with, and/or when \(p &lt; n\), manipulating the
matrices via these relationships rather than forming \(W\) directly can
have huge advantageous because it avoids having to create the (typically
dense) matrix $$A^{-1} + U B^{-1} V$$ directly.</p>
    <h2 class="hasAnchor" id="symmetric-form"><a class="anchor" href="#symmetric-form"></a>Symmetric form</h2>

    

<p>Where applicable, it's worth using the symmetric form of the matrix. This
takes advantage of the symmetry where possible to speed up operations, takes
less memory, and sometimes has numerical benefits. This function will create
the symmetric form in the following circumstances:</p><ul>
<li><p><code>symmetry = TRUE</code>; or</p></li>
<li><p>the argument <code>X</code> is provided; or</p></li>
<li><p><code>A</code> and <code>B</code> are symmetric (according to
  <code><a href='https://rdrr.io/r/base/isSymmetric.html'>isSymmetric</a></code>) and the arguments <code>U</code> and <code>V</code> are
  NOT provided.</p></li>
</ul>

    <h2 class="hasAnchor" id="multiple-b-matrices"><a class="anchor" href="#multiple-b-matrices"></a>Multiple B matrices</h2>

    

<p>A more general form allows for multiple B matrices:
$$A^{-1} + \sum_{i = 1}^n U_i B_i^{-1} V_i,$$
and analogously for the symmetric form. You can use this form by providing
a list of matrices as the <code>B</code> (or <code>U</code>, <code>V</code> or <code>X</code>)
arguments. Internally, this is implemented by converting to the standard form
by letting <code>B = bdiag(...the B matrices...)</code>,
<code>U = cbind(..the U matrices...)</code>, and so on.</p>
<p>The <code>B</code>, <code>U</code>, <code>V</code> and <code>X</code> values are recycled to the
length of the longest list, so you can, for instance, provide multiple B
matrices but only one U matrix (and vice-versa).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>More information on the underlying linear algebra can be found
in Harville, D. A. (1997) &lt;doi:10.1007/b98818&gt;.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='WoodburyMatrix-class.html'>WoodburyMatrix</a>, <a href='solve-methods.html'>solve</a>, <a href='instantiate.html'>instantiate</a></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>Matrix</span>)
<span class='co'># Example solving a linear system with general matrices</span>
<span class='no'>A</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/Matrix/man/Diagonal.html'>Diagonal</a></span>(<span class='fl'>100</span>)
<span class='no'>B</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/Matrix/man/rsparsematrix.html'>rsparsematrix</a></span>(<span class='fl'>100</span>, <span class='fl'>100</span>, <span class='fl'>0.5</span>)
<span class='no'>W</span> <span class='kw'>&lt;-</span> <span class='fu'>WoodburyMatrix</span>(<span class='no'>A</span>, <span class='no'>B</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span>(<span class='fu'><a href='solve-methods.html'>solve</a></span>(<span class='no'>W</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>100</span>)))</div><div class='output co'>#&gt; Formal class 'dgeMatrix' [package "Matrix"] with 4 slots
#&gt;   ..@ x       : num [1:100] 3.85 3.14 7.77 -5.45 9 ...
#&gt;   ..@ Dim     : int [1:2] 100 1
#&gt;   ..@ Dimnames:List of 2
#&gt;   .. ..$ : NULL
#&gt;   .. ..$ : NULL
#&gt;   ..@ factors : list()</div><div class='input'>
<span class='co'># Calculating the determinant of a symmetric system</span>
<span class='no'>A</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/Matrix/man/Diagonal.html'>Diagonal</a></span>(<span class='fl'>100</span>)
<span class='no'>B</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/Matrix/man/rsparsematrix.html'>rsparsematrix</a></span>(<span class='fl'>100</span>, <span class='fl'>100</span>, <span class='fl'>0.5</span>, <span class='kw'>symmetric</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>W</span> <span class='kw'>&lt;-</span> <span class='fu'>WoodburyMatrix</span>(<span class='no'>A</span>, <span class='no'>B</span>, <span class='kw'>symmetric</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/det.html'>determinant</a></span>(<span class='no'>W</span>))</div><div class='output co'>#&gt; $modulus
#&gt; [1] 7.128002
#&gt; attr(,"logarithm")
#&gt; [1] TRUE
#&gt; 
#&gt; $sign
#&gt; [1] 1
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "det"</div><div class='input'>
<span class='co'># Having a lower rank B matrix and an X matrix</span>
<span class='no'>A</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/Matrix/man/Diagonal.html'>Diagonal</a></span>(<span class='fl'>100</span>)
<span class='no'>B</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/Matrix/man/rsparsematrix.html'>rsparsematrix</a></span>(<span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>1</span>, <span class='kw'>symmetric</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/Matrix/man/rsparsematrix.html'>rsparsematrix</a></span>(<span class='fl'>100</span>, <span class='fl'>10</span>, <span class='fl'>1</span>)
<span class='no'>W</span> <span class='kw'>&lt;-</span> <span class='fu'>WoodburyMatrix</span>(<span class='no'>A</span>, <span class='no'>B</span>, <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>X</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span>(<span class='fu'><a href='solve-methods.html'>solve</a></span>(<span class='no'>W</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>100</span>)))</div><div class='output co'>#&gt; Formal class 'dgeMatrix' [package "Matrix"] with 4 slots
#&gt;   ..@ x       : num [1:100] 1.185 -1.868 0.163 0.589 2.636 ...
#&gt;   ..@ Dim     : int [1:2] 100 1
#&gt;   ..@ Dimnames:List of 2
#&gt;   .. ..$ : NULL
#&gt;   .. ..$ : NULL
#&gt;   ..@ factors : list()</div><div class='input'>
<span class='co'># Multiple B matrices</span>
<span class='no'>A</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/Matrix/man/Diagonal.html'>Diagonal</a></span>(<span class='fl'>100</span>)
<span class='no'>B1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/Matrix/man/rsparsematrix.html'>rsparsematrix</a></span>(<span class='fl'>100</span>, <span class='fl'>100</span>, <span class='fl'>1</span>, <span class='kw'>symmetric</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>B2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/Matrix/man/rsparsematrix.html'>rsparsematrix</a></span>(<span class='fl'>100</span>, <span class='fl'>100</span>, <span class='fl'>1</span>, <span class='kw'>symmetric</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>W</span> <span class='kw'>&lt;-</span> <span class='fu'>WoodburyMatrix</span>(<span class='no'>A</span>, <span class='kw'>B</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>B1</span>, <span class='no'>B2</span>))
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span>(<span class='fu'><a href='solve-methods.html'>solve</a></span>(<span class='no'>W</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>100</span>)))</div><div class='output co'>#&gt; Formal class 'dgeMatrix' [package "Matrix"] with 4 slots
#&gt;   ..@ x       : num [1:100] -2.92 -3.28 2.63 -3.32 0.69 ...
#&gt;   ..@ Dim     : int [1:2] 100 1
#&gt;   ..@ Dimnames:List of 2
#&gt;   .. ..$ : NULL
#&gt;   .. ..$ : NULL
#&gt;   ..@ factors : list()</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Michael Bertolacci.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


